{% extends "registry/submission_step.html" %}
{% load i18n %}
{% block body %}

    <script type="text/javascript">
    function cloneMore(selector, type) {
        var newElement = $(selector).clone(true);
        var total = $('#id_' + type + '-TOTAL_FORMS').val();
        newElement.find(':input').each(function() {
            var name = $(this).attr('name').replace('-' + (total-1) + '-','-' + total + '-');
            var id = 'id_' + name;
            $(this).attr({'name': name, 'id': id});
            if($(this).attr('type')!='hidden')$(this).val('').removeAttr('checked');
        });
        newElement.find('label').each(function() {
            var newFor = $(this).attr('for').replace('-' + (total-1) + '-','-' + total + '-');
            $(this).attr('for', newFor);
        });
        total++;
        $('#id_' + type + '-TOTAL_FORMS').val(total);
        newElement.css("display","none");
        $(selector).after(newElement);
        newElement.show("fast");
    }
        $(document).ready(function() {
                $("select[multiple]").asmSelect({
                        addItemTarget: 'bottom',
                        animate: true,
                        highlight: true,
                        sortable: true
                });
        });
        // management_form.prefix
    </script>

    <form action="./" method="POST">
        {% for form in forms %}
            <h2>{% firstof form.title form.form.title %}</h2>
            <table>
                {{ form.as_table }}
            </table>
        {% endfor %}

        {% for formset in formsets %}
            {{ formset.management_form }}
            <h2>{{ formset.form.title }}</h2>

            <div class="{{formset.management_form.prefix}}">
            {% for form in formset.forms %}
                <table>
                    {{ form.as_table }}
                </table>
            {% endfor %}
            </div>
            <div style="text-align: center">
              <input onclick="cloneMore('div.{{formset.management_form.prefix}} table:last','{{formset.management_form.prefix}}')" type="button" value="add more"/>
            </div>
        {% endfor %}

        <br/>

        <input name="submit_go" type="submit" value="{% trans "Save and continue later" %}"/>

        {% if next_form_title %}
        <input name="submit_next" type="submit" value="{% trans "Save and go to" %} '{{next_form_title}}'"/>
        {% endif %}
    </form>

{% endblock %}
